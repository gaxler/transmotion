<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="prev" title="transmotion" href="modules.html" />

    <meta name="generator" content="sphinx-4.5.0, furo 2022.09.29"/>
        <title>transmotion package - TransMotion documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">TransMotion  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">TransMotion  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Stages of Motion Transfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="train_signal.html">Training Signals</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="modules.html">transmotion</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">transmotion package</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="transmotion-package">
<h1>transmotion package<a class="headerlink" href="#transmotion-package" title="Permalink to this headline">#</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">#</a></h2>
</section>
<section id="module-transmotion.blocks">
<span id="transmotion-blocks-module"></span><h2>transmotion.blocks module<a class="headerlink" href="#module-transmotion.blocks" title="Permalink to this headline">#</a></h2>
<p>Building Block with trainable parameters</p>
<dl class="py class">
<dt class="sig sig-object py" id="transmotion.blocks.AntiAliasInterpolation2d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transmotion.blocks.</span></span><span class="sig-name descname"><span class="pre">AntiAliasInterpolation2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/blocks.html#AntiAliasInterpolation2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.blocks.AntiAliasInterpolation2d" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>You can get more info on anti-aliasing for image resize here:
- [The dangers behind image resizing](<a class="reference external" href="https://blog.zuru.tech/machine-learning/2021/08/09/the-dangers-behind-image-resizing">https://blog.zuru.tech/machine-learning/2021/08/09/the-dangers-behind-image-resizing</a>)</p>
<dl class="py method">
<dt class="sig sig-object py" id="transmotion.blocks.AntiAliasInterpolation2d.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/transmotion/blocks.html#AntiAliasInterpolation2d.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.blocks.AntiAliasInterpolation2d.forward" title="Permalink to this definition">#</a></dt>
<dd><p>Apply Gaussian Kerenl Before doing nearest neighbor interpolation</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="transmotion.blocks.ImagePyramid">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transmotion.blocks.</span></span><span class="sig-name descname"><span class="pre">ImagePyramid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scales</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/blocks.html#ImagePyramid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.blocks.ImagePyramid" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Create image pyramide for computing pyramide perceptual loss. See Sec 3.3</p>
<dl class="py method">
<dt class="sig sig-object py" id="transmotion.blocks.ImagePyramid.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fmap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/transmotion/blocks.html#ImagePyramid.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.blocks.ImagePyramid.forward" title="Permalink to this definition">#</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transmotion.blocks.ImagePyramid.nearest_scale">
<span class="sig-name descname"><span class="pre">nearest_scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.nn.modules.module.Module</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/transmotion/blocks.html#ImagePyramid.nearest_scale"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.blocks.ImagePyramid.nearest_scale" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-transmotion.configs">
<span id="transmotion-configs-module"></span><h2>transmotion.configs module<a class="headerlink" href="#module-transmotion.configs" title="Permalink to this headline">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="transmotion.configs.BackgroundLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transmotion.configs.</span></span><span class="sig-name descname"><span class="pre">BackgroundLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/configs.html#BackgroundLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.configs.BackgroundLoss" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.BackgroundLoss.loss_weight">
<span class="sig-name descname"><span class="pre">loss_weight</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#transmotion.configs.BackgroundLoss.loss_weight" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="transmotion.configs.DataLoadingConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transmotion.configs.</span></span><span class="sig-name descname"><span class="pre">DataLoadingConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/configs.html#DataLoadingConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.configs.DataLoadingConfig" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.DataLoadingConfig.batch_size">
<span class="sig-name descname"><span class="pre">batch_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#transmotion.configs.DataLoadingConfig.batch_size" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.DataLoadingConfig.num_workers">
<span class="sig-name descname"><span class="pre">num_workers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#transmotion.configs.DataLoadingConfig.num_workers" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="transmotion.configs.DenseMotionConf">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transmotion.configs.</span></span><span class="sig-name descname"><span class="pre">DenseMotionConf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#transmotion.configs.TPSConfig" title="transmotion.configs.TPSConfig"><span class="pre">transmotion.configs.TPSConfig</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_blocks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kp_variance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_occlusion_masks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/configs.html#DenseMotionConf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.configs.DenseMotionConf" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.DenseMotionConf.base_dim">
<span class="sig-name descname"><span class="pre">base_dim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#transmotion.configs.DenseMotionConf.base_dim" title="Permalink to this definition">#</a></dt>
<dd><p>Dimension that encoder and decoder networks start from. This dim multiplied in each block i by a factor of <span class="math notranslate nohighlight">\(2^i\)</span></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.DenseMotionConf.in_features">
<span class="sig-name descname"><span class="pre">in_features</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#transmotion.configs.DenseMotionConf.in_features" title="Permalink to this definition">#</a></dt>
<dd><p>Input dimension to the dense motion network. Usually the input is an image so this value is 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.DenseMotionConf.kp_variance">
<span class="sig-name descname"><span class="pre">kp_variance</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.01</span></em><a class="headerlink" href="#transmotion.configs.DenseMotionConf.kp_variance" title="Permalink to this definition">#</a></dt>
<dd><p>Variance used in Gaussian heatmaps representation</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.DenseMotionConf.max_features">
<span class="sig-name descname"><span class="pre">max_features</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#transmotion.configs.DenseMotionConf.max_features" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.DenseMotionConf.num_blocks">
<span class="sig-name descname"><span class="pre">num_blocks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#transmotion.configs.DenseMotionConf.num_blocks" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.DenseMotionConf.num_occlusion_masks">
<span class="sig-name descname"><span class="pre">num_occlusion_masks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">4</span></em><a class="headerlink" href="#transmotion.configs.DenseMotionConf.num_occlusion_masks" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.DenseMotionConf.scale_factor">
<span class="sig-name descname"><span class="pre">scale_factor</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.25</span></em><a class="headerlink" href="#transmotion.configs.DenseMotionConf.scale_factor" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.DenseMotionConf.tps">
<span class="sig-name descname"><span class="pre">tps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#transmotion.configs.TPSConfig" title="transmotion.configs.TPSConfig"><span class="pre">transmotion.configs.TPSConfig</span></a></em><a class="headerlink" href="#transmotion.configs.DenseMotionConf.tps" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="transmotion.configs.DropoutConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transmotion.configs.</span></span><span class="sig-name descname"><span class="pre">DropoutConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_epoch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_prob</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_prob</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prob_inc_epochs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/configs.html#DropoutConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.configs.DropoutConfig" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Drop-out is applied during training to the DenseMotion network. Its not a property of the network but an external param to the forward pass.
So the config for that is in general train config and not the dense motion config.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>prob_inc_epoch</strong> – Increment dropout probability over this amount of epochs</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.DropoutConfig.init_prob">
<span class="sig-name descname"><span class="pre">init_prob</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#transmotion.configs.DropoutConfig.init_prob" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.DropoutConfig.max_prob">
<span class="sig-name descname"><span class="pre">max_prob</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#transmotion.configs.DropoutConfig.max_prob" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.DropoutConfig.prob_inc_epochs">
<span class="sig-name descname"><span class="pre">prob_inc_epochs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">10</span></em><a class="headerlink" href="#transmotion.configs.DropoutConfig.prob_inc_epochs" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.DropoutConfig.start_epoch">
<span class="sig-name descname"><span class="pre">start_epoch</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#transmotion.configs.DropoutConfig.start_epoch" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="transmotion.configs.EquivarianceLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transmotion.configs.</span></span><span class="sig-name descname"><span class="pre">EquivarianceLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sigma_tps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_affine</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points_per_tps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/configs.html#EquivarianceLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.configs.EquivarianceLoss" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This loss requires a random TPS transformation, the parameters of this transformation are specified here.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.EquivarianceLoss.loss_weight">
<span class="sig-name descname"><span class="pre">loss_weight</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#transmotion.configs.EquivarianceLoss.loss_weight" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.EquivarianceLoss.points_per_tps">
<span class="sig-name descname"><span class="pre">points_per_tps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#transmotion.configs.EquivarianceLoss.points_per_tps" title="Permalink to this definition">#</a></dt>
<dd><p>number of control points to use for the TPS</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.EquivarianceLoss.sigma_affine">
<span class="sig-name descname"><span class="pre">sigma_affine</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#transmotion.configs.EquivarianceLoss.sigma_affine" title="Permalink to this definition">#</a></dt>
<dd><p>standard deviation for affine transform params (generated randomly)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.EquivarianceLoss.sigma_tps">
<span class="sig-name descname"><span class="pre">sigma_tps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#transmotion.configs.EquivarianceLoss.sigma_tps" title="Permalink to this definition">#</a></dt>
<dd><p>standard deviation for TPS kernel mixing params (generated randomly)</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="transmotion.configs.InpaintingConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transmotion.configs.</span></span><span class="sig-name descname"><span class="pre">InpaintingConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_down_blocks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_occlusion_masks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/configs.html#InpaintingConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.configs.InpaintingConfig" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.InpaintingConfig.base_dim">
<span class="sig-name descname"><span class="pre">base_dim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#transmotion.configs.InpaintingConfig.base_dim" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.InpaintingConfig.in_features">
<span class="sig-name descname"><span class="pre">in_features</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#transmotion.configs.InpaintingConfig.in_features" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.InpaintingConfig.max_features">
<span class="sig-name descname"><span class="pre">max_features</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#transmotion.configs.InpaintingConfig.max_features" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.InpaintingConfig.num_down_blocks">
<span class="sig-name descname"><span class="pre">num_down_blocks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#transmotion.configs.InpaintingConfig.num_down_blocks" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.InpaintingConfig.num_occlusion_masks">
<span class="sig-name descname"><span class="pre">num_occlusion_masks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#transmotion.configs.InpaintingConfig.num_occlusion_masks" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="transmotion.configs.LossConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transmotion.configs.</span></span><span class="sig-name descname"><span class="pre">LossConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">perceptual</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#transmotion.configs.PerceptualLoss" title="transmotion.configs.PerceptualLoss"><span class="pre">transmotion.configs.PerceptualLoss</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">equivariance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#transmotion.configs.EquivarianceLoss" title="transmotion.configs.EquivarianceLoss"><span class="pre">transmotion.configs.EquivarianceLoss</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">warp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#transmotion.configs.WarpLoss" title="transmotion.configs.WarpLoss"><span class="pre">transmotion.configs.WarpLoss</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">background</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#transmotion.configs.BackgroundLoss" title="transmotion.configs.BackgroundLoss"><span class="pre">transmotion.configs.BackgroundLoss</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/configs.html#LossConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.configs.LossConfig" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.LossConfig.background">
<span class="sig-name descname"><span class="pre">background</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#transmotion.configs.BackgroundLoss" title="transmotion.configs.BackgroundLoss"><span class="pre">transmotion.configs.BackgroundLoss</span></a></em><a class="headerlink" href="#transmotion.configs.LossConfig.background" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.LossConfig.equivariance">
<span class="sig-name descname"><span class="pre">equivariance</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#transmotion.configs.EquivarianceLoss" title="transmotion.configs.EquivarianceLoss"><span class="pre">transmotion.configs.EquivarianceLoss</span></a></em><a class="headerlink" href="#transmotion.configs.LossConfig.equivariance" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.LossConfig.perceptual">
<span class="sig-name descname"><span class="pre">perceptual</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#transmotion.configs.PerceptualLoss" title="transmotion.configs.PerceptualLoss"><span class="pre">transmotion.configs.PerceptualLoss</span></a></em><a class="headerlink" href="#transmotion.configs.LossConfig.perceptual" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.LossConfig.warp">
<span class="sig-name descname"><span class="pre">warp</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#transmotion.configs.WarpLoss" title="transmotion.configs.WarpLoss"><span class="pre">transmotion.configs.WarpLoss</span></a></em><a class="headerlink" href="#transmotion.configs.LossConfig.warp" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="transmotion.configs.OptimizerConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transmotion.configs.</span></span><span class="sig-name descname"><span class="pre">OptimizerConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_lr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_decay_epoch_sched</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_decay_gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adam_beta1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adam_beta2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.999</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/configs.html#OptimizerConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.configs.OptimizerConfig" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Learning rates, decay parameters and scheduling</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.OptimizerConfig.adam_beta1">
<span class="sig-name descname"><span class="pre">adam_beta1</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.5</span></em><a class="headerlink" href="#transmotion.configs.OptimizerConfig.adam_beta1" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.OptimizerConfig.adam_beta2">
<span class="sig-name descname"><span class="pre">adam_beta2</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.999</span></em><a class="headerlink" href="#transmotion.configs.OptimizerConfig.adam_beta2" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.OptimizerConfig.initial_lr">
<span class="sig-name descname"><span class="pre">initial_lr</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#transmotion.configs.OptimizerConfig.initial_lr" title="Permalink to this definition">#</a></dt>
<dd><p>base learning rate for the optimizer</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.OptimizerConfig.lr_decay_epoch_sched">
<span class="sig-name descname"><span class="pre">lr_decay_epoch_sched</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#transmotion.configs.OptimizerConfig.lr_decay_epoch_sched" title="Permalink to this definition">#</a></dt>
<dd><p>Sequence of epoch numbers that represent learning rate decay steps. decay is by lr_decay_gamma</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.OptimizerConfig.lr_decay_gamma">
<span class="sig-name descname"><span class="pre">lr_decay_gamma</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#transmotion.configs.OptimizerConfig.lr_decay_gamma" title="Permalink to this definition">#</a></dt>
<dd><p>Learning rate decay parameter. Decay happens according to lr_decay_epoch_sched</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.OptimizerConfig.weight_decay">
<span class="sig-name descname"><span class="pre">weight_decay</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0001</span></em><a class="headerlink" href="#transmotion.configs.OptimizerConfig.weight_decay" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="transmotion.configs.PerceptualLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transmotion.configs.</span></span><span class="sig-name descname"><span class="pre">PerceptualLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scales</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/configs.html#PerceptualLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.configs.PerceptualLoss" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Get VGG features from multiple scales of the driving image and the generated image.
Train on generated images with <span class="math notranslate nohighlight">\(L_1\)</span> loss.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.PerceptualLoss.in_dim">
<span class="sig-name descname"><span class="pre">in_dim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#transmotion.configs.PerceptualLoss.in_dim" title="Permalink to this definition">#</a></dt>
<dd><p>Perceptual loss multi-scale image pyramid, this is the in dimension of the pyramid input</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.PerceptualLoss.loss_weights">
<span class="sig-name descname"><span class="pre">loss_weights</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#transmotion.configs.PerceptualLoss.loss_weights" title="Permalink to this definition">#</a></dt>
<dd><p>Loss weights (for each scale) when aggreagted into total loss value</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.PerceptualLoss.scales">
<span class="sig-name descname"><span class="pre">scales</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#transmotion.configs.PerceptualLoss.scales" title="Permalink to this definition">#</a></dt>
<dd><p>List of float number that represent the scaling factors to be applied on the images. This needs to conform to the number of feature maps you get from the perceptual loss network.
By default we use VGG19 here, this net has 5 feature map output. #TODO: Might need to make this more general and explicitly link number of feature maps to number of scales.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="transmotion.configs.TPSConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transmotion.configs.</span></span><span class="sig-name descname"><span class="pre">TPSConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_tps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points_per_tps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/configs.html#TPSConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.configs.TPSConfig" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.TPSConfig.num_tps">
<span class="sig-name descname"><span class="pre">num_tps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#transmotion.configs.TPSConfig.num_tps" title="Permalink to this definition">#</a></dt>
<dd><p>We use multiple TPS transforms. Here you specify the number to use</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.TPSConfig.points_per_tps">
<span class="sig-name descname"><span class="pre">points_per_tps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#transmotion.configs.TPSConfig.points_per_tps" title="Permalink to this definition">#</a></dt>
<dd><p>Each TPS transform has a number of control points that will be matched exactly. Here you specify the number of those points</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="transmotion.configs.TrainConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transmotion.configs.</span></span><span class="sig-name descname"><span class="pre">TrainConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_loading</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#transmotion.configs.DataLoadingConfig" title="transmotion.configs.DataLoadingConfig"><span class="pre">transmotion.configs.DataLoadingConfig</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_epochs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#transmotion.configs.OptimizerConfig" title="transmotion.configs.OptimizerConfig"><span class="pre">transmotion.configs.OptimizerConfig</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#transmotion.configs.DropoutConfig" title="transmotion.configs.DropoutConfig"><span class="pre">transmotion.configs.DropoutConfig</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dense_motion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#transmotion.configs.DenseMotionConf" title="transmotion.configs.DenseMotionConf"><span class="pre">transmotion.configs.DenseMotionConf</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">inpainting</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#transmotion.configs.InpaintingConfig" title="transmotion.configs.InpaintingConfig"><span class="pre">transmotion.configs.InpaintingConfig</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">tps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#transmotion.configs.TPSConfig" title="transmotion.configs.TPSConfig"><span class="pre">transmotion.configs.TPSConfig</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#transmotion.configs.LossConfig" title="transmotion.configs.LossConfig"><span class="pre">transmotion.configs.LossConfig</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">background_start_epoch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/configs.html#TrainConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.configs.TrainConfig" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Specifies all the parameters needed for training</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.TrainConfig.background_start_epoch">
<span class="sig-name descname"><span class="pre">background_start_epoch</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#transmotion.configs.TrainConfig.background_start_epoch" title="Permalink to this definition">#</a></dt>
<dd><p>You might want to start background training later, this specifies what epoch bg training will start</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.TrainConfig.data_loading">
<span class="sig-name descname"><span class="pre">data_loading</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#transmotion.configs.DataLoadingConfig" title="transmotion.configs.DataLoadingConfig"><span class="pre">transmotion.configs.DataLoadingConfig</span></a></em><a class="headerlink" href="#transmotion.configs.TrainConfig.data_loading" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.TrainConfig.dense_motion">
<span class="sig-name descname"><span class="pre">dense_motion</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#transmotion.configs.DenseMotionConf" title="transmotion.configs.DenseMotionConf"><span class="pre">transmotion.configs.DenseMotionConf</span></a></em><a class="headerlink" href="#transmotion.configs.TrainConfig.dense_motion" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.TrainConfig.dropout">
<span class="sig-name descname"><span class="pre">dropout</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#transmotion.configs.DropoutConfig" title="transmotion.configs.DropoutConfig"><span class="pre">transmotion.configs.DropoutConfig</span></a></em><a class="headerlink" href="#transmotion.configs.TrainConfig.dropout" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.TrainConfig.image_size">
<span class="sig-name descname"><span class="pre">image_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#transmotion.configs.TrainConfig.image_size" title="Permalink to this definition">#</a></dt>
<dd><p>TPS works on square images of size <code class="docutils literal notranslate"><span class="pre">image_size</span> <span class="pre">x</span> <span class="pre">image_size</span></code></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.TrainConfig.inpainting">
<span class="sig-name descname"><span class="pre">inpainting</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#transmotion.configs.InpaintingConfig" title="transmotion.configs.InpaintingConfig"><span class="pre">transmotion.configs.InpaintingConfig</span></a></em><a class="headerlink" href="#transmotion.configs.TrainConfig.inpainting" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.TrainConfig.loss">
<span class="sig-name descname"><span class="pre">loss</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#transmotion.configs.LossConfig" title="transmotion.configs.LossConfig"><span class="pre">transmotion.configs.LossConfig</span></a></em><a class="headerlink" href="#transmotion.configs.TrainConfig.loss" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.TrainConfig.num_epochs">
<span class="sig-name descname"><span class="pre">num_epochs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#transmotion.configs.TrainConfig.num_epochs" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.TrainConfig.optimizer">
<span class="sig-name descname"><span class="pre">optimizer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#transmotion.configs.OptimizerConfig" title="transmotion.configs.OptimizerConfig"><span class="pre">transmotion.configs.OptimizerConfig</span></a></em><a class="headerlink" href="#transmotion.configs.TrainConfig.optimizer" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.TrainConfig.tps">
<span class="sig-name descname"><span class="pre">tps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#transmotion.configs.TPSConfig" title="transmotion.configs.TPSConfig"><span class="pre">transmotion.configs.TPSConfig</span></a></em><a class="headerlink" href="#transmotion.configs.TrainConfig.tps" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="transmotion.configs.WarpLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transmotion.configs.</span></span><span class="sig-name descname"><span class="pre">WarpLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/configs.html#WarpLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.configs.WarpLoss" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.configs.WarpLoss.loss_weight">
<span class="sig-name descname"><span class="pre">loss_weight</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#transmotion.configs.WarpLoss.loss_weight" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="transmotion.configs.dummy_conf">
<span class="sig-prename descclassname"><span class="pre">transmotion.configs.</span></span><span class="sig-name descname"><span class="pre">dummy_conf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#transmotion.configs.TrainConfig" title="transmotion.configs.TrainConfig"><span class="pre">transmotion.configs.TrainConfig</span></a></span></span><a class="reference internal" href="_modules/transmotion/configs.html#dummy_conf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.configs.dummy_conf" title="Permalink to this definition">#</a></dt>
<dd><p>VOX model dummy config</p>
</dd></dl>

</section>
<section id="module-transmotion.cord_warp">
<span id="transmotion-cord-warp-module"></span><h2>transmotion.cord_warp module<a class="headerlink" href="#module-transmotion.cord_warp" title="Permalink to this headline">#</a></h2>
<p>Thin-Plate Spline Transform implementation and some helper functions to work with points and grids.</p>
<dl class="py class">
<dt class="sig sig-object py" id="transmotion.cord_warp.ThinPlateSpline">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transmotion.cord_warp.</span></span><span class="sig-name descname"><span class="pre">ThinPlateSpline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">control_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">control_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_warp_cords</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/cord_warp.html#ThinPlateSpline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.cord_warp.ThinPlateSpline" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This Spline is equivalent ot a function that transforms a set of point to be close to some other set of point while keeping the transformation smooth.
The other set of points are the control points and smoothness is measured as the second derivative of the transformation.</p>
<p>we have the following params in this transformation:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(A_k, b_k\)</span> = theta</p></li>
<li><p><span class="math notranslate nohighlight">\(W_k\)</span> = control params</p></li>
<li><p><span class="math notranslate nohighlight">\(p_k\)</span> = control points</p></li>
</ul>
<p>To transform a point P:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\hat{P} = (A_k p + b_k) + W_k U(|| p_k - p ||)\]</div>
</div>
<p><span class="math notranslate nohighlight">\(U\)</span> is the Kernel function.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.cord_warp.ThinPlateSpline.control_params">
<span class="sig-name descname"><span class="pre">control_params</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">torch.Tensor</span></em><a class="headerlink" href="#transmotion.cord_warp.ThinPlateSpline.control_params" title="Permalink to this definition">#</a></dt>
<dd><p>Weights that we apply on our kernel function</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.cord_warp.ThinPlateSpline.control_points">
<span class="sig-name descname"><span class="pre">control_points</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">torch.Tensor</span></em><a class="headerlink" href="#transmotion.cord_warp.ThinPlateSpline.control_points" title="Permalink to this definition">#</a></dt>
<dd><p>The points that our transformation needs to match exactly. Shape - <code class="docutils literal notranslate"><span class="pre">[b,</span> <span class="pre">K,</span> <span class="pre">2]</span></code> Each new point we transform is am affine combination of control set point. each control point is weighted according to a kernel distance from the point being transformed</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transmotion.cord_warp.ThinPlateSpline.fit">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_pts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">destination_pts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/cord_warp.html#ThinPlateSpline.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.cord_warp.ThinPlateSpline.fit" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>source_pts - <cite>[bs, num_tps, pts_per_tps, 2]</cite> source points for TPS transform</p>
</dd>
<dt class="field-even">Param</dt>
<dd class="field-even"><p>destination_pts - <cite>[bs, num_tps, pts_per_tps, 2]</cite> destination points for TPS transform</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transmotion.cord_warp.ThinPlateSpline.random">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">random</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sigma_tps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_affine</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_transforms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/cord_warp.html#ThinPlateSpline.random"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.cord_warp.ThinPlateSpline.random" title="Permalink to this definition">#</a></dt>
<dd><p>Random Transform is a special case of the full TPS. This one does a random affine transform and jitter them in a diagonal (weighted by TPS params)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.cord_warp.ThinPlateSpline.theta">
<span class="sig-name descname"><span class="pre">theta</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">torch.Tensor</span></em><a class="headerlink" href="#transmotion.cord_warp.ThinPlateSpline.theta" title="Permalink to this definition">#</a></dt>
<dd><p>Affine Transform Parameters [bs, K, 2, 3] a batch of K TPS transforms</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transmotion.cord_warp.ThinPlateSpline.warp_cords">
<span class="sig-name descname"><span class="pre">warp_cords</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coordinates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/transmotion/cord_warp.html#ThinPlateSpline.warp_cords"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.cord_warp.ThinPlateSpline.warp_cords" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>coordinates - <cite>[bs, h, w, d]</cite> coordinates to be wrapped</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>[bs, K, h, w, d]</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="transmotion.cord_warp.conform_to_type_and_device">
<span class="sig-prename descclassname"><span class="pre">transmotion.cord_warp.</span></span><span class="sig-name descname"><span class="pre">conform_to_type_and_device</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">leader</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/transmotion/cord_warp.html#conform_to_type_and_device"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.cord_warp.conform_to_type_and_device" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="transmotion.cord_warp.deform_with_4d_deformation">
<span class="sig-prename descclassname"><span class="pre">transmotion.cord_warp.</span></span><span class="sig-name descname"><span class="pre">deform_with_4d_deformation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frame</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deformation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/transmotion/cord_warp.html#deform_with_4d_deformation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.cord_warp.deform_with_4d_deformation" title="Permalink to this definition">#</a></dt>
<dd><p>Apply pythorch’s <code class="docutils literal notranslate"><span class="pre">grid_sample</span></code> with <code class="docutils literal notranslate"><span class="pre">align_corners</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frame</strong> – shape [b, d, h, w]</p></li>
<li><p><strong>deformation</strong> – shape [b, h, w, 2]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="transmotion.cord_warp.deform_with_5d_deformation">
<span class="sig-prename descclassname"><span class="pre">transmotion.cord_warp.</span></span><span class="sig-name descname"><span class="pre">deform_with_5d_deformation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frame</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deformation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/transmotion/cord_warp.html#deform_with_5d_deformation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.cord_warp.deform_with_5d_deformation" title="Permalink to this definition">#</a></dt>
<dd><p>Deform image frame according to wrapped coordinates.
The deformation is done with PyTorch’s <code class="docutils literal notranslate"><span class="pre">grid_sample</span></code> that takes 4D tensors as deformation coordinates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>deformation</strong> (<em>[</em><em>bs</em><em>, </em><em>K</em><em>, </em><em>h</em><em>, </em><em>w</em><em>, </em><em>d</em><em>]</em>) – Batch of K coordinates grids that describe where each pixel should go</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="transmotion.cord_warp.grid_like_featuremap">
<span class="sig-prename descclassname"><span class="pre">transmotion.cord_warp.</span></span><span class="sig-name descname"><span class="pre">grid_like_featuremap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fmap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/transmotion/cord_warp.html#grid_like_featuremap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.cord_warp.grid_like_featuremap" title="Permalink to this definition">#</a></dt>
<dd><p>Generate coordinate grid with same spatial size, type and device as fmap
:param fmap: Feature map tensor to be used as spatial shape.
.. note:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Assumes</span> <span class="n">last</span> <span class="n">two</span> <span class="n">dimension</span> <span class="n">are</span> <span class="n">height</span> <span class="ow">and</span> <span class="n">width</span>
</pre></div>
</div>
<dl class="field-list simple">
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="transmotion.cord_warp.make_coordinate_grid">
<span class="sig-prename descclassname"><span class="pre">transmotion.cord_warp.</span></span><span class="sig-name descname"><span class="pre">make_coordinate_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/transmotion/cord_warp.html#make_coordinate_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.cord_warp.make_coordinate_grid" title="Permalink to this definition">#</a></dt>
<dd><p>Create a meshgrid <cite>[-1,1] x [-1,1]</cite> with shape of <cite>[height, width, 2]</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>shape [height, width, 2]</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-transmotion.data_loading">
<span id="transmotion-data-loading-module"></span><h2>transmotion.data_loading module<a class="headerlink" href="#module-transmotion.data_loading" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="transmotion.data_loading.image_to_tensor">
<span class="sig-prename descclassname"><span class="pre">transmotion.data_loading.</span></span><span class="sig-name descname"><span class="pre">image_to_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/transmotion/data_loading.html#image_to_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.data_loading.image_to_tensor" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="transmotion.data_loading.load_driving_video">
<span class="sig-prename descclassname"><span class="pre">transmotion.data_loading.</span></span><span class="sig-name descname"><span class="pre">load_driving_video</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vid_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/data_loading.html#load_driving_video"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.data_loading.load_driving_video" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="transmotion.data_loading.map_numpy">
<span class="sig-prename descclassname"><span class="pre">transmotion.data_loading.</span></span><span class="sig-name descname"><span class="pre">map_numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">funcs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">it</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/transmotion/data_loading.html#map_numpy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.data_loading.map_numpy" title="Permalink to this definition">#</a></dt>
<dd><p>Map a sequence of function that take numpy array and return a numpy array over an iterator of numpy arrays.</p>
<p>This is a helper function to apply transformations on the video iterator.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="transmotion.data_loading.video_iterator">
<span class="sig-prename descclassname"><span class="pre">transmotion.data_loading.</span></span><span class="sig-name descname"><span class="pre">video_iterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fpath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/transmotion/data_loading.html#video_iterator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.data_loading.video_iterator" title="Permalink to this definition">#</a></dt>
<dd><p>Turn a video file into an iterator over frames
.. note:: This uses imageio for video decoding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fpath</strong> – Path to video file</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="transmotion.data_loading.video_to_tensor">
<span class="sig-prename descclassname"><span class="pre">transmotion.data_loading.</span></span><span class="sig-name descname"><span class="pre">video_to_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vid_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/data_loading.html#video_to_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.data_loading.video_to_tensor" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="module-transmotion.datasets">
<span id="transmotion-datasets-module"></span><h2>transmotion.datasets module<a class="headerlink" href="#module-transmotion.datasets" title="Permalink to this headline">#</a></h2>
<p>In training you sample a video, and sample two frames out of the video, one of the frames serves as the source and the other as driving.</p>
<p>we get a video array, in training this will be two frames out of the video, in reconstruction mode, we take all of the frames.</p>
<ul class="simple">
<li><p>they load the whole video to get only two frames out of it. in demo run, the use all of the frames.</p></li>
</ul>
<p>pretty simple actually</p>
<dl class="py class">
<dt class="sig sig-object py" id="transmotion.datasets.SourceDrivingBatch">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transmotion.datasets.</span></span><span class="sig-name descname"><span class="pre">SourceDrivingBatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">driving</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/datasets.html#SourceDrivingBatch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.datasets.SourceDrivingBatch" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source</strong> – source image, shape [bs, d (=3), h, w]</p></li>
<li><p><strong>driving</strong> – source image, shape [bs, d (=3), h, w]</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.datasets.SourceDrivingBatch.driving">
<span class="sig-name descname"><span class="pre">driving</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">torch.Tensor</span></em><a class="headerlink" href="#transmotion.datasets.SourceDrivingBatch.driving" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.datasets.SourceDrivingBatch.source">
<span class="sig-name descname"><span class="pre">source</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">torch.Tensor</span></em><a class="headerlink" href="#transmotion.datasets.SourceDrivingBatch.source" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="transmotion.datasets.SourceDrivingSample">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transmotion.datasets.</span></span><span class="sig-name descname"><span class="pre">SourceDrivingSample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">driving</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/datasets.html#SourceDrivingSample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.datasets.SourceDrivingSample" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source</strong> – source image, shape [d (=3), h, w]</p></li>
<li><p><strong>driving</strong> – source image, shape [d (=3), h, w]</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.datasets.SourceDrivingSample.driving">
<span class="sig-name descname"><span class="pre">driving</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">torch.Tensor</span></em><a class="headerlink" href="#transmotion.datasets.SourceDrivingSample.driving" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.datasets.SourceDrivingSample.source">
<span class="sig-name descname"><span class="pre">source</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">torch.Tensor</span></em><a class="headerlink" href="#transmotion.datasets.SourceDrivingSample.source" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="transmotion.datasets.collate_fn">
<span class="sig-prename descclassname"><span class="pre">transmotion.datasets.</span></span><span class="sig-name descname"><span class="pre">collate_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#transmotion.datasets.SourceDrivingSample" title="transmotion.datasets.SourceDrivingSample"><span class="pre">transmotion.datasets.SourceDrivingSample</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#transmotion.datasets.SourceDrivingBatch" title="transmotion.datasets.SourceDrivingBatch"><span class="pre">transmotion.datasets.SourceDrivingBatch</span></a></span></span><a class="reference internal" href="_modules/transmotion/datasets.html#collate_fn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.datasets.collate_fn" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="module-transmotion.debug">
<span id="transmotion-debug-module"></span><h2>transmotion.debug module<a class="headerlink" href="#module-transmotion.debug" title="Permalink to this headline">#</a></h2>
<p>This is an ad-hoc code used for debugging gaps in the dense motion generation network.
Can safely ignore, its here “for my records”</p>
<dl class="py class">
<dt class="sig sig-object py" id="transmotion.debug.MMapDebug">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transmotion.debug.</span></span><span class="sig-name descname"><span class="pre">MMapDebug</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fpath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/debug.html#MMapDebug"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.debug.MMapDebug" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="transmotion.debug.MMapDebug.comp">
<span class="sig-name descname"><span class="pre">comp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/debug.html#MMapDebug.comp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.debug.MMapDebug.comp" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transmotion.debug.MMapDebug.push">
<span class="sig-name descname"><span class="pre">push</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/debug.html#MMapDebug.push"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.debug.MMapDebug.push" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-transmotion.dense_motion">
<span id="transmotion-dense-motion-module"></span><h2>transmotion.dense_motion module<a class="headerlink" href="#module-transmotion.dense_motion" title="Permalink to this headline">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="transmotion.dense_motion.BGMotionParam">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transmotion.dense_motion.</span></span><span class="sig-name descname"><span class="pre">BGMotionParam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bg_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/dense_motion.html#BGMotionParam"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.dense_motion.BGMotionParam" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.dense_motion.BGMotionParam.bg_params">
<span class="sig-name descname"><span class="pre">bg_params</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">torch.Tensor</span></em><a class="headerlink" href="#transmotion.dense_motion.BGMotionParam.bg_params" title="Permalink to this definition">#</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">[bs,</span> <span class="pre">3,</span> <span class="pre">3]</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Affine transform parameters (3x3 shape, with last row as bias [0,0,1]) Shape</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="transmotion.dense_motion.BGMotionPredictor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transmotion.dense_motion.</span></span><span class="sig-name descname"><span class="pre">BGMotionPredictor</span></span><a class="reference internal" href="_modules/transmotion/dense_motion.html#BGMotionPredictor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.dense_motion.BGMotionPredictor" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Module for background estimation, return single transformation, parametrized as 3x3 matrix. The third row is [0 0 1]</p>
<p>This is a spearate module since we don’t train it from the start, it starts as None, and appears as the model has some training weights</p>
<dl class="py method">
<dt class="sig sig-object py" id="transmotion.dense_motion.BGMotionPredictor.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_image</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">driving_image</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#transmotion.dense_motion.BGMotionParam" title="transmotion.dense_motion.BGMotionParam"><span class="pre">transmotion.dense_motion.BGMotionParam</span></a></span></span><a class="reference internal" href="_modules/transmotion/dense_motion.html#BGMotionPredictor.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.dense_motion.BGMotionPredictor.forward" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source_imgae</strong> – [bs, d, h, w]</p></li>
<li><p><strong>driving_imgae</strong> – [bs, d, h, w]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="transmotion.dense_motion.DenseMotionNetwork">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transmotion.dense_motion.</span></span><span class="sig-name descname"><span class="pre">DenseMotionNetwork</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#transmotion.configs.DenseMotionConf" title="transmotion.configs.DenseMotionConf"><span class="pre">transmotion.configs.DenseMotionConf</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/dense_motion.html#DenseMotionNetwork"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.dense_motion.DenseMotionNetwork" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<ol class="arabic simple">
<li><p>Estimate optical flow from key-point transformatiopn,</p></li>
<li><p>Estimate multi-resolution occlusion masks</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>hg_to_num_mappings</strong> – Conv layer that translates HourGlass output dimension to the number of mappings (in this case num of TPS transforms + bkg transform)</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="transmotion.dense_motion.DenseMotionNetwork.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_kp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#transmotion.kp_detection.KPResult" title="transmotion.kp_detection.KPResult"><span class="pre">transmotion.kp_detection.KPResult</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">drv_kp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#transmotion.kp_detection.KPResult" title="transmotion.kp_detection.KPResult"><span class="pre">transmotion.kp_detection.KPResult</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">bg_param</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#transmotion.dense_motion.BGMotionParam" title="transmotion.dense_motion.BGMotionParam"><span class="pre">transmotion.dense_motion.BGMotionParam</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_prob</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#transmotion.dense_motion.DenseMotionResult" title="transmotion.dense_motion.DenseMotionResult"><span class="pre">transmotion.dense_motion.DenseMotionResult</span></a></span></span><a class="reference internal" href="_modules/transmotion/dense_motion.html#DenseMotionNetwork.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.dense_motion.DenseMotionNetwork.forward" title="Permalink to this definition">#</a></dt>
<dd><p>Flow of the forward pass:</p>
<ul class="simple">
<li><p>Downsample the source image</p></li>
<li><p>Generate heatmap representation out of the source and driving key-points</p></li>
<li><p>Fit Thin-Plate Spline to source and driving key-points</p></li>
<li><p>Deform source image with TPS transform (happens in <a class="reference internal" href="#transmotion.dense_motion.tps_warp_to_keypoints_with_background" title="transmotion.dense_motion.tps_warp_to_keypoints_with_background"><code class="xref py py-func docutils literal notranslate"><span class="pre">tps_warp_to_keypoints_with_background()</span></code></a>)</p></li>
<li><p>Concat heatmaps and deformed source and pass that thorough an hour-glass neural-net (HG)</p></li>
<li><p>Infer optical-flow from last HG feature-map</p></li>
<li><p>Infer occlusion masks from the last HG feature-map</p></li>
</ul>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.dense_motion.DenseMotionNetwork.hg_to_num_mappings">
<span class="sig-name descname"><span class="pre">hg_to_num_mappings</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">torch.nn.modules.module.Module</span></em><a class="headerlink" href="#transmotion.dense_motion.DenseMotionNetwork.hg_to_num_mappings" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transmotion.dense_motion.DenseMotionNetwork.infer_optical_flow">
<span class="sig-name descname"><span class="pre">infer_optical_flow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fmap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warpped_cords</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_prob</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/transmotion/dense_motion.html#DenseMotionNetwork.infer_optical_flow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.dense_motion.DenseMotionNetwork.infer_optical_flow" title="Permalink to this definition">#</a></dt>
<dd><p>Turn the output of the hour-glass architecture into a softmax weights tensor and use that reduce K+1 transformed cords to a single optical-flow tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fmap</strong> (<em>4-D Batched Tensor</em>) – Last output of the HourGlass architecture used to infer contribution maps</p></li>
<li><p><strong>warpped_cords</strong> – Shape: [b k h w d] coordinates after beign warped with a TPS transform</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Optical-flow Tensor (shape: [b h w d]) and the weights (shape: [b k h w]) assigned to each of the transformations.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transmotion.dense_motion.DenseMotionNetwork.maybe_upsample_infer_occlusion_masks">
<span class="sig-name descname"><span class="pre">maybe_upsample_infer_occlusion_masks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_maps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/transmotion/dense_motion.html#DenseMotionNetwork.maybe_upsample_infer_occlusion_masks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.dense_motion.DenseMotionNetwork.maybe_upsample_infer_occlusion_masks" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="transmotion.dense_motion.DenseMotionResult">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transmotion.dense_motion.</span></span><span class="sig-name descname"><span class="pre">DenseMotionResult</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deformed_source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contribution_maps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optical_flow</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occlusion_masks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/dense_motion.html#DenseMotionResult"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.dense_motion.DenseMotionResult" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Output of the DenseMotionNetwork</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>deformed_source</strong> – Source image deformed by K TPS transformations (not by the optical flow!)</p></li>
<li><p><strong>contribution_maps</strong> – Convex weights on each of the TPS transforms &amp; background transform</p></li>
<li><p><strong>optical_flow</strong> – a grid of coordinates <span class="math notranslate nohighlight">\(\in [0,1]\)</span>, every coordinate tells us where grid pixel should be moved</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.dense_motion.DenseMotionResult.contribution_maps">
<span class="sig-name descname"><span class="pre">contribution_maps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">torch.Tensor</span></em><a class="headerlink" href="#transmotion.dense_motion.DenseMotionResult.contribution_maps" title="Permalink to this definition">#</a></dt>
<dd><p>Shape  - <code class="docutils literal notranslate"><span class="pre">[bs,</span> <span class="pre">K+1,</span> <span class="pre">h,</span> <span class="pre">w]</span></code></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.dense_motion.DenseMotionResult.deformed_source">
<span class="sig-name descname"><span class="pre">deformed_source</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">torch.Tensor</span></em><a class="headerlink" href="#transmotion.dense_motion.DenseMotionResult.deformed_source" title="Permalink to this definition">#</a></dt>
<dd><p>Shape - <code class="docutils literal notranslate"><span class="pre">[bs,</span> <span class="pre">K+1,</span> <span class="pre">h</span> <span class="pre">w]</span></code></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.dense_motion.DenseMotionResult.occlusion_masks">
<span class="sig-name descname"><span class="pre">occlusion_masks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#transmotion.dense_motion.DenseMotionResult.occlusion_masks" title="Permalink to this definition">#</a></dt>
<dd><p>Shpae of element i - <code class="docutils literal notranslate"><span class="pre">[bs,</span> <span class="pre">d_i,</span> <span class="pre">h_i,</span> <span class="pre">w_i]</span></code></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.dense_motion.DenseMotionResult.optical_flow">
<span class="sig-name descname"><span class="pre">optical_flow</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">torch.Tensor</span></em><a class="headerlink" href="#transmotion.dense_motion.DenseMotionResult.optical_flow" title="Permalink to this definition">#</a></dt>
<dd><p>Shape - <code class="docutils literal notranslate"><span class="pre">[bs,</span> <span class="pre">h,</span> <span class="pre">w,</span> <span class="pre">d</span> <span class="pre">(=2)]</span></code></p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="transmotion.dense_motion.LearnedUpsample">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transmotion.dense_motion.</span></span><span class="sig-name descname"><span class="pre">LearnedUpsample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_upsamples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/dense_motion.html#LearnedUpsample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.dense_motion.LearnedUpsample" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>upsampled_dims</strong> – Dimension sizes of the upsampled feature maps</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="transmotion.dense_motion.LearnedUpsample.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fmap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/transmotion/dense_motion.html#LearnedUpsample.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.dense_motion.LearnedUpsample.forward" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fmap</strong> (<em>[</em><em>bs</em><em>, </em><em>d</em><em>, </em><em>h</em><em>, </em><em>w</em><em>]</em>) – Feature map that is going to be upsampled (usually the last one)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of upsampled featute maps</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>[[bs, d // 2, h*2, w*2], [bs, d//4, h*4, w*4], … ]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="transmotion.dense_motion.OcclusionMasks">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transmotion.dense_motion.</span></span><span class="sig-name descname"><span class="pre">OcclusionMasks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fmap_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/dense_motion.html#OcclusionMasks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.dense_motion.OcclusionMasks" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mask_predicotrs</strong> – Conv layers followed by Sigmoid activation. kernel_size=7 and padding preserves spatial dimension</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="transmotion.dense_motion.OcclusionMasks.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fmaps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/transmotion/dense_motion.html#OcclusionMasks.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.dense_motion.OcclusionMasks.forward" title="Permalink to this definition">#</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="transmotion.dense_motion.WarppedCords">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transmotion.dense_motion.</span></span><span class="sig-name descname"><span class="pre">WarppedCords</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">warpped_cords</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_tps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/dense_motion.html#WarppedCords"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.dense_motion.WarppedCords" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>wrapped_cords</strong> – Shape <code class="docutils literal notranslate"><span class="pre">[bs,</span> <span class="pre">num_tps+1,</span> <span class="pre">gird_h,</span> <span class="pre">grid_w,</span> <span class="pre">2]</span></code></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="transmotion.dense_motion.WarppedCords.deform_frame">
<span class="sig-name descname"><span class="pre">deform_frame</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frame</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/transmotion/dense_motion.html#WarppedCords.deform_frame"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.dense_motion.WarppedCords.deform_frame" title="Permalink to this definition">#</a></dt>
<dd><p>Multi-deformation. One frames gets deformed by several different deformation coordinates
Deform image frame according to the wrapped coordinates
:return: shape <code class="docutils literal notranslate"><span class="pre">[b</span> <span class="pre">K+1</span> <span class="pre">d</span> <span class="pre">h</span> <span class="pre">w]</span></code></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.dense_motion.WarppedCords.num_tps">
<span class="sig-name descname"><span class="pre">num_tps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#transmotion.dense_motion.WarppedCords.num_tps" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.dense_motion.WarppedCords.warpped_cords">
<span class="sig-name descname"><span class="pre">warpped_cords</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">torch.Tensor</span></em><a class="headerlink" href="#transmotion.dense_motion.WarppedCords.warpped_cords" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="transmotion.dense_motion.keypoints_to_heatmap_representation">
<span class="sig-prename descclassname"><span class="pre">transmotion.dense_motion.</span></span><span class="sig-name descname"><span class="pre">keypoints_to_heatmap_representation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_hw</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#transmotion.kp_detection.KPResult" title="transmotion.kp_detection.KPResult"><span class="pre">transmotion.kp_detection.KPResult</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">driving</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#transmotion.kp_detection.KPResult" title="transmotion.kp_detection.KPResult"><span class="pre">transmotion.kp_detection.KPResult</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">kp_variance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/transmotion/dense_motion.html#keypoints_to_heatmap_representation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.dense_motion.keypoints_to_heatmap_representation" title="Permalink to this definition">#</a></dt>
<dd><p>create a heatmap representation from key-point results
For motion estimation this should be the size of the source images as key-points heatmap is going to be concatenated with tohe source image</p>
<dl class="field-list simple">
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>spatial_hw - spatial size of the produces heatmap.</p>
</dd>
<dt class="field-even">Source</dt>
<dd class="field-even"><p>Predicted Key-points for the source image</p>
</dd>
<dt class="field-odd">Driving</dt>
<dd class="field-odd"><p>Predicted Key-points for the driving image</p>
</dd>
<dt class="field-even">Kp_variance</dt>
<dd class="field-even"><p>Key-points representation is based on a Gaussian distribution. this is the variacne for the distribution we fit.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Tensor with shpae of <a href="#id1"><span class="problematic" id="id2">`</span></a>[bs, K*N+1, h, w]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="transmotion.dense_motion.tps_dropout_softmax">
<span class="sig-prename descclassname"><span class="pre">transmotion.dense_motion.</span></span><span class="sig-name descname"><span class="pre">tps_dropout_softmax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fmap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_prob</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/transmotion/dense_motion.html#tps_dropout_softmax"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.dense_motion.tps_dropout_softmax" title="Permalink to this definition">#</a></dt>
<dd><p>We want to do some drop out on the K TPS transforms so that the model will learn to use all of them.
We never drop the background features
:param fmap: represents features of background and K TPS transforms
:type fmap: [bs, K+1, h. w]</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="transmotion.dense_motion.tps_warp_to_keypoints_with_background">
<span class="sig-prename descclassname"><span class="pre">transmotion.dense_motion.</span></span><span class="sig-name descname"><span class="pre">tps_warp_to_keypoints_with_background</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid_hw</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#transmotion.kp_detection.KPResult" title="transmotion.kp_detection.KPResult"><span class="pre">transmotion.kp_detection.KPResult</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">driving</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#transmotion.kp_detection.KPResult" title="transmotion.kp_detection.KPResult"><span class="pre">transmotion.kp_detection.KPResult</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">bkg_affine_param</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#transmotion.dense_motion.BGMotionParam" title="transmotion.dense_motion.BGMotionParam"><span class="pre">transmotion.dense_motion.BGMotionParam</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#transmotion.dense_motion.WarppedCords" title="transmotion.dense_motion.WarppedCords"><span class="pre">transmotion.dense_motion.WarppedCords</span></a></span></span><a class="reference internal" href="_modules/transmotion/dense_motion.html#tps_warp_to_keypoints_with_background"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.dense_motion.tps_warp_to_keypoints_with_background" title="Permalink to this definition">#</a></dt>
<dd><p>Warp a grid of coordinates of shape <code class="docutils literal notranslate"><span class="pre">grid_hw</span></code>
Predicted key-points are for foreground objects. This function warps a grid according to foreground transformation and adds a background
Each point in the resulting grid says to what point we mapped the current point. Last dimension is the identity, that is the grid without any mapping</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>bkg_affine_param</strong> – Shape <cite>[bs, 3, 3]</cite> if not None</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tensor with shape <a href="#id3"><span class="problematic" id="id4">`</span></a>[bs, num_tps+1, gird_h, grid_w, 2]</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-transmotion.inpainting">
<span id="transmotion-inpainting-module"></span><h2>transmotion.inpainting module<a class="headerlink" href="#module-transmotion.inpainting" title="Permalink to this headline">#</a></h2>
<p>In-painting network</p>
<dl class="py class">
<dt class="sig sig-object py" id="transmotion.inpainting.InpaintingNetwork">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transmotion.inpainting.</span></span><span class="sig-name descname"><span class="pre">InpaintingNetwork</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#transmotion.configs.InpaintingConfig" title="transmotion.configs.InpaintingConfig"><span class="pre">transmotion.configs.InpaintingConfig</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/inpainting.html#InpaintingNetwork"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.inpainting.InpaintingNetwork" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="transmotion.inpainting.InpaintingNetwork.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occlusion_masks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optical_flow</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#transmotion.inpainting.InpaintingResult" title="transmotion.inpainting.InpaintingResult"><span class="pre">transmotion.inpainting.InpaintingResult</span></a></span></span><a class="reference internal" href="_modules/transmotion/inpainting.html#InpaintingNetwork.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.inpainting.InpaintingNetwork.forward" title="Permalink to this definition">#</a></dt>
<dd><p>Forward pass has the following flow:</p>
<ul class="simple">
<li><p>encode source image to produce encoder features</p></li>
<li><p>produce optical-flow deformed (<a class="reference internal" href="#transmotion.inpainting.resize_deform" title="transmotion.inpainting.resize_deform"><code class="xref py py-func docutils literal notranslate"><span class="pre">resize_deform()</span></code></a>) and mask occluded features (<a class="reference internal" href="#transmotion.inpainting.resize_occlude" title="transmotion.inpainting.resize_occlude"><code class="xref py py-func docutils literal notranslate"><span class="pre">resize_occlude()</span></code></a>). we have two version of the encoder features, one with full gradients and another with gradient only on the optical-flow.</p></li>
<li><p>use the deformed features as inputs to the decoder</p></li>
<li><p>deform and occlude the source image</p></li>
<li><p>final prediction is a convex combination of the deforemed-occluded source image and the inverse occluded decoder output</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source_img</strong> (<code class="docutils literal notranslate"><span class="pre">[bs,</span> <span class="pre">3,</span> <span class="pre">h,</span> <span class="pre">w]</span></code>) – Source image batch</p></li>
<li><p><strong>occlusion_masks</strong> (<code class="docutils literal notranslate"><span class="pre">[bs,</span> <span class="pre">d_i,</span> <span class="pre">h_i,</span> <span class="pre">w_i]</span></code> for i-th element of the list) – List of multi scale occlusion masks produced by <a class="reference internal" href="#transmotion.dense_motion.DenseMotionNetwork" title="transmotion.dense_motion.DenseMotionNetwork"><code class="xref py py-class docutils literal notranslate"><span class="pre">transmotion.dense_motion.DenseMotionNetwork</span></code></a>.</p></li>
<li><p><strong>optical_flow</strong> (<code class="docutils literal notranslate"><span class="pre">[bs,</span> <span class="pre">h,</span> <span class="pre">w,</span> <span class="pre">d</span> <span class="pre">(=2)]</span></code>) – a grid of coordinates, every coordinate tells us where grid pixel should be moved</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A Check that the number of occlusion masks is consistent with the number of down-blocks happens during config initx</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transmotion.inpainting.InpaintingNetwork.fwd_decoder">
<span class="sig-name descname"><span class="pre">fwd_decoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raw_encoding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occlusion_masks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optical_flow</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#transmotion.inpainting.InpaintingResult" title="transmotion.inpainting.InpaintingResult"><span class="pre">transmotion.inpainting.InpaintingResult</span></a></span></span><a class="reference internal" href="_modules/transmotion/inpainting.html#InpaintingNetwork.fwd_decoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.inpainting.InpaintingNetwork.fwd_decoder" title="Permalink to this definition">#</a></dt>
<dd><p>Decoder forward func, it takes Encoder result as input, deforms, occludes and decodes it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source_img</strong> (<code class="docutils literal notranslate"><span class="pre">[bs,</span> <span class="pre">3,</span> <span class="pre">h,</span> <span class="pre">w]</span></code>) – Source image batch</p></li>
<li><p><strong>raw_encoding</strong> – Output of the fwd_encoder func</p></li>
<li><p><strong>occlusion_masks</strong> (<code class="docutils literal notranslate"><span class="pre">[bs,</span> <span class="pre">d_i,</span> <span class="pre">h_i,</span> <span class="pre">w_i]</span></code> for i-th element of the list) – List of multi scale occlusion masks produced by <a class="reference internal" href="#transmotion.dense_motion.DenseMotionNetwork" title="transmotion.dense_motion.DenseMotionNetwork"><code class="xref py py-class docutils literal notranslate"><span class="pre">transmotion.dense_motion.DenseMotionNetwork</span></code></a>.</p></li>
<li><p><strong>optical_flow</strong> (<code class="docutils literal notranslate"><span class="pre">[bs,</span> <span class="pre">h,</span> <span class="pre">w,</span> <span class="pre">d</span> <span class="pre">(=2)]</span></code>) – a grid of coordinates, every coordinate tells us where grid pixel should be moved</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transmotion.inpainting.InpaintingNetwork.fwd_encoder">
<span class="sig-name descname"><span class="pre">fwd_encoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/transmotion/inpainting.html#InpaintingNetwork.fwd_encoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.inpainting.InpaintingNetwork.fwd_encoder" title="Permalink to this definition">#</a></dt>
<dd><p>Run the encoders forward pass. This function is here because you don’t need to re-run the encdoer during inference.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>source_img</strong> (<code class="docutils literal notranslate"><span class="pre">[bs,</span> <span class="pre">3,</span> <span class="pre">h,</span> <span class="pre">w]</span></code>) – Source image batch</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Encodings and optical flow deformed image (same shape as input image)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transmotion.inpainting.InpaintingNetwork.get_encode_no_grad">
<span class="sig-name descname"><span class="pre">get_encode_no_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">driver_img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occlusion_masks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/transmotion/inpainting.html#InpaintingNetwork.get_encode_no_grad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.inpainting.InpaintingNetwork.get_encode_no_grad" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Decreasing dimension and increasing spatial size</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="transmotion.inpainting.InpaintingResult">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transmotion.inpainting.</span></span><span class="sig-name descname"><span class="pre">InpaintingResult</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deformed_src_fmaps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deformed_source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inpainted_img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/inpainting.html#InpaintingResult"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.inpainting.InpaintingResult" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>deformed_src_fmaps</strong> – encoder feture map after deformation and occlusion, those have <strong>gradients on the optical flow tensor</strong>.</p></li>
<li><p><strong>deformed_source</strong> – Source image <strong>deformed with optical flow</strong></p></li>
<li><p><strong>inpainted_img</strong> – generated image from source such that it matches driving pose</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.inpainting.InpaintingResult.deformed_source">
<span class="sig-name descname"><span class="pre">deformed_source</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">torch.Tensor</span></em><a class="headerlink" href="#transmotion.inpainting.InpaintingResult.deformed_source" title="Permalink to this definition">#</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">[bs,</span> <span class="pre">d,</span> <span class="pre">h,</span> <span class="pre">w]</span></code></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.inpainting.InpaintingResult.deformed_src_fmaps">
<span class="sig-name descname"><span class="pre">deformed_src_fmaps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#transmotion.inpainting.InpaintingResult.deformed_src_fmaps" title="Permalink to this definition">#</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">[bs,</span> <span class="pre">d_i,</span> <span class="pre">h_i,</span> <span class="pre">w_i]</span></code> i-th element of the list</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.inpainting.InpaintingResult.inpainted_img">
<span class="sig-name descname"><span class="pre">inpainted_img</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">torch.Tensor</span></em><a class="headerlink" href="#transmotion.inpainting.InpaintingResult.inpainted_img" title="Permalink to this definition">#</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">[bs,</span> <span class="pre">d,</span> <span class="pre">h,</span> <span class="pre">w]</span></code></p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="transmotion.inpainting.resize_deform">
<span class="sig-prename descclassname"><span class="pre">transmotion.inpainting.</span></span><span class="sig-name descname"><span class="pre">resize_deform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frame</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deformation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/transmotion/inpainting.html#resize_deform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.inpainting.resize_deform" title="Permalink to this definition">#</a></dt>
<dd><p>Deform frame according to coordinate deformation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>deformation</strong> (<code class="docutils literal notranslate"><span class="pre">[bs,</span> <span class="pre">h1,</span> <span class="pre">w1,</span> <span class="pre">d</span> <span class="pre">(=2)]</span></code>) – A grid of coordinates <span class="math notranslate nohighlight">\(\in [0,1]\)</span>.</p></li>
<li><p><strong>frame</strong> (<code class="docutils literal notranslate"><span class="pre">[bs,</span> <span class="pre">d,</span> <span class="pre">h2</span> <span class="pre">,w2]</span></code>) – An image of a feature map</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Deformed feature map (<code class="docutils literal notranslate"><span class="pre">[bs,</span> <span class="pre">d,</span> <span class="pre">h2</span> <span class="pre">,w2]</span></code>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="transmotion.inpainting.resize_occlude">
<span class="sig-prename descclassname"><span class="pre">transmotion.inpainting.</span></span><span class="sig-name descname"><span class="pre">resize_occlude</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frame</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occlusion_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/transmotion/inpainting.html#resize_occlude"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.inpainting.resize_occlude" title="Permalink to this definition">#</a></dt>
<dd><p>Occlude feature map :fmap: using occlusion_mask.
If mask is not the same size as feature map, use bilinear interpolation on the mask
to align the sizes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frame</strong> – [bs, d, h1, w1]</p></li>
<li><p><strong>occlusion_mask</strong> – [bs, 1, h2, w2]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Occluded image <code class="docutils literal notranslate"><span class="pre">[bs,</span> <span class="pre">d,</span> <span class="pre">h1,</span> <span class="pre">w1]</span></code></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-transmotion.kp_detection">
<span id="transmotion-kp-detection-module"></span><h2>transmotion.kp_detection module<a class="headerlink" href="#module-transmotion.kp_detection" title="Permalink to this headline">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="transmotion.kp_detection.KPDetector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transmotion.kp_detection.</span></span><span class="sig-name descname"><span class="pre">KPDetector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#transmotion.configs.TPSConfig" title="transmotion.configs.TPSConfig"><span class="pre">transmotion.configs.TPSConfig</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/kp_detection.html#KPDetector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.kp_detection.KPDetector" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>The network is ResNet-18 that produces <strong>num_tps*points_per_tps*spatial_dim</strong> dimensional feature.
We later interpret the output as key-points of the shape: <code class="docutils literal notranslate"><span class="pre">[num_tps,</span> <span class="pre">points_per_tps,</span> <span class="pre">spatial_dim]</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="transmotion.kp_detection.KPDetector.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#transmotion.kp_detection.KPResult" title="transmotion.kp_detection.KPResult"><span class="pre">transmotion.kp_detection.KPResult</span></a></span></span><a class="reference internal" href="_modules/transmotion/kp_detection.html#KPDetector.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.kp_detection.KPDetector.forward" title="Permalink to this definition">#</a></dt>
<dd><p>Runs on a btach of images <code class="docutils literal notranslate"><span class="pre">[b,</span> <span class="pre">c,</span> <span class="pre">h,</span> <span class="pre">w]</span></code></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.kp_detection.KPDetector.spatial_dim">
<span class="sig-name descname"><span class="pre">spatial_dim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#transmotion.kp_detection.KPDetector.spatial_dim" title="Permalink to this definition">#</a></dt>
<dd><p>Spatial dimension of key-point coordinates</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="transmotion.kp_detection.KPResult">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transmotion.kp_detection.</span></span><span class="sig-name descname"><span class="pre">KPResult</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">foreground_kp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_tps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pts_per_tps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/kp_detection.html#KPResult"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.kp_detection.KPResult" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The result of a KeyPoint estimation network. With shape of <code class="docutils literal notranslate"><span class="pre">[batch,</span> <span class="pre">num_tps_transforms,</span> <span class="pre">points_per_tps,</span> <span class="pre">2]</span></code>
The network produces parameters for a TPS transformation.</p>
<p>Each TPS transformation has 5 parameters on every 2D spatial location
:param foreground_kp: 2D coordinates in <code class="docutils literal notranslate"><span class="pre">[-1,1]</span></code> of shape <code class="docutils literal notranslate"><span class="pre">[batch,</span> <span class="pre">num_tps_transforms,</span> <span class="pre">points_per_tps,</span> <span class="pre">2]</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.kp_detection.KPResult.batch_size">
<span class="sig-name descname"><span class="pre">batch_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#transmotion.kp_detection.KPResult.batch_size" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transmotion.kp_detection.KPResult.detach_to_cpu">
<span class="sig-name descname"><span class="pre">detach_to_cpu</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#transmotion.kp_detection.KPResult" title="transmotion.kp_detection.KPResult"><span class="pre">transmotion.kp_detection.KPResult</span></a></span></span><a class="reference internal" href="_modules/transmotion/kp_detection.html#KPResult.detach_to_cpu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.kp_detection.KPResult.detach_to_cpu" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.kp_detection.KPResult.foreground_kp">
<span class="sig-name descname"><span class="pre">foreground_kp</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">torch.Tensor</span></em><a class="headerlink" href="#transmotion.kp_detection.KPResult.foreground_kp" title="Permalink to this definition">#</a></dt>
<dd><p>2D coordinates in <cite>[-1,1]</cite> of shape <cite>[batch, num_tps_transforms, points_per_tps, 2]</cite></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transmotion.kp_detection.KPResult.normalize_relative_to">
<span class="sig-name descname"><span class="pre">normalize_relative_to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#transmotion.kp_detection.KPResult" title="transmotion.kp_detection.KPResult"><span class="pre">transmotion.kp_detection.KPResult</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cur_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#transmotion.kp_detection.KPResult" title="transmotion.kp_detection.KPResult"><span class="pre">transmotion.kp_detection.KPResult</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#transmotion.kp_detection.KPResult" title="transmotion.kp_detection.KPResult"><span class="pre">transmotion.kp_detection.KPResult</span></a></span></span><a class="reference internal" href="_modules/transmotion/kp_detection.html#KPResult.normalize_relative_to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.kp_detection.KPResult.normalize_relative_to" title="Permalink to this definition">#</a></dt>
<dd><p>Normalize key-points relative to some initial key-point and current key-points.</p>
<p>Take the difference vectors of current key-points to some initial key-points. Use the difference vectors to translate current key points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init</strong> – initial key-points</p></li>
<li><p><strong>cur</strong> – current key-points</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This normalization is used during inference. We modify the source key-points according to the change to the driving key-points. This way no identity information is leaked from driving to source.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.kp_detection.KPResult.num_tps">
<span class="sig-name descname"><span class="pre">num_tps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#transmotion.kp_detection.KPResult.num_tps" title="Permalink to this definition">#</a></dt>
<dd><p>Number of Thin-Plate Splines in the predicted key-points</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.kp_detection.KPResult.pts_per_tps">
<span class="sig-name descname"><span class="pre">pts_per_tps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#transmotion.kp_detection.KPResult.pts_per_tps" title="Permalink to this definition">#</a></dt>
<dd><p>Number of control points per TPS transform</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transmotion.kp_detection.KPResult.to_gaussians">
<span class="sig-name descname"><span class="pre">to_gaussians</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hw_of_grid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kp_variance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/transmotion/kp_detection.html#KPResult.to_gaussians"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.kp_detection.KPResult.to_gaussians" title="Permalink to this definition">#</a></dt>
<dd><p>Transform a keypoints of shape <code class="docutils literal notranslate"><span class="pre">[batch,</span> <span class="pre">num_tps,</span> <span class="pre">pts_per_tps,</span> <span class="pre">2]</span></code> into gaussian like representation of shape <code class="docutils literal notranslate"><span class="pre">[bs,</span> <span class="pre">num_tps,</span> <span class="pre">pts_per_tps,</span> <span class="pre">grid_h,</span> <span class="pre">grid_w]</span></code></p>
<ul class="simple">
<li><p>By “Gaussian Like” we mean find distance between predicted key-points and a uniform spread grid.</p></li>
<li><p>We get back a uniform spread grid with gaussian density centered around each key-point</p></li>
</ul>
<p>We sometimes refer to the number of TPS transforms as K, number of points per TPS transform as N and number of points in a grid as P (= h*w)
:param hw_of_grid: Height and Width of of the Gaussian representation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is a convenience method, this is used when generating heatmaps for the optical-flow estimation</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-transmotion.network_bundle">
<span id="transmotion-network-bundle-module"></span><h2>transmotion.network_bundle module<a class="headerlink" href="#module-transmotion.network_bundle" title="Permalink to this headline">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="transmotion.network_bundle.NetworkBundleResult">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transmotion.network_bundle.</span></span><span class="sig-name descname"><span class="pre">NetworkBundleResult</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_keypoints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#transmotion.kp_detection.KPResult" title="transmotion.kp_detection.KPResult"><span class="pre">transmotion.kp_detection.KPResult</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">driving_keypoints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#transmotion.kp_detection.KPResult" title="transmotion.kp_detection.KPResult"><span class="pre">transmotion.kp_detection.KPResult</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">background_param</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#transmotion.dense_motion.BGMotionParam" title="transmotion.dense_motion.BGMotionParam"><span class="pre">transmotion.dense_motion.BGMotionParam</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dense_motion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#transmotion.dense_motion.DenseMotionResult" title="transmotion.dense_motion.DenseMotionResult"><span class="pre">transmotion.dense_motion.DenseMotionResult</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">inpainting</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#transmotion.inpainting.InpaintingResult" title="transmotion.inpainting.InpaintingResult"><span class="pre">transmotion.inpainting.InpaintingResult</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/network_bundle.html#NetworkBundleResult"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.network_bundle.NetworkBundleResult" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The result of a forward pass. This includes traintime debugging information like source and target ke:50y-points
Optical flow maps, deformed feature maps etc… Final generated frame is available as a property generated_image</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.network_bundle.NetworkBundleResult.background_param">
<span class="sig-name descname"><span class="pre">background_param</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#transmotion.dense_motion.BGMotionParam" title="transmotion.dense_motion.BGMotionParam"><span class="pre">transmotion.dense_motion.BGMotionParam</span></a></em><a class="headerlink" href="#transmotion.network_bundle.NetworkBundleResult.background_param" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.network_bundle.NetworkBundleResult.dense_motion">
<span class="sig-name descname"><span class="pre">dense_motion</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#transmotion.dense_motion.DenseMotionResult" title="transmotion.dense_motion.DenseMotionResult"><span class="pre">transmotion.dense_motion.DenseMotionResult</span></a></em><a class="headerlink" href="#transmotion.network_bundle.NetworkBundleResult.dense_motion" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.network_bundle.NetworkBundleResult.driving_keypoints">
<span class="sig-name descname"><span class="pre">driving_keypoints</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#transmotion.kp_detection.KPResult" title="transmotion.kp_detection.KPResult"><span class="pre">transmotion.kp_detection.KPResult</span></a></em><a class="headerlink" href="#transmotion.network_bundle.NetworkBundleResult.driving_keypoints" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="transmotion.network_bundle.NetworkBundleResult.generated_image">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">generated_image</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">torch.Tensor</span></em><a class="headerlink" href="#transmotion.network_bundle.NetworkBundleResult.generated_image" title="Permalink to this definition">#</a></dt>
<dd><p>Final result. Generated source iamge that matches the pose of the drivign image</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Detached from autograd on copied to CPU</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.network_bundle.NetworkBundleResult.inpainting">
<span class="sig-name descname"><span class="pre">inpainting</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#transmotion.inpainting.InpaintingResult" title="transmotion.inpainting.InpaintingResult"><span class="pre">transmotion.inpainting.InpaintingResult</span></a></em><a class="headerlink" href="#transmotion.network_bundle.NetworkBundleResult.inpainting" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.network_bundle.NetworkBundleResult.source_keypoints">
<span class="sig-name descname"><span class="pre">source_keypoints</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#transmotion.kp_detection.KPResult" title="transmotion.kp_detection.KPResult"><span class="pre">transmotion.kp_detection.KPResult</span></a></em><a class="headerlink" href="#transmotion.network_bundle.NetworkBundleResult.source_keypoints" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="transmotion.network_bundle.NetworksBundle">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transmotion.network_bundle.</span></span><span class="sig-name descname"><span class="pre">NetworksBundle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#transmotion.kp_detection.KPDetector" title="transmotion.kp_detection.KPDetector"><span class="pre">transmotion.kp_detection.KPDetector</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dense_motion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#transmotion.dense_motion.DenseMotionNetwork" title="transmotion.dense_motion.DenseMotionNetwork"><span class="pre">transmotion.dense_motion.DenseMotionNetwork</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">inpaint</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#transmotion.inpainting.InpaintingNetwork" title="transmotion.inpainting.InpaintingNetwork"><span class="pre">transmotion.inpainting.InpaintingNetwork</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">background_motion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#transmotion.dense_motion.BGMotionPredictor" title="transmotion.dense_motion.BGMotionPredictor"><span class="pre">transmotion.dense_motion.BGMotionPredictor</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/network_bundle.html#NetworksBundle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.network_bundle.NetworksBundle" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.network_bundle.NetworksBundle.background_motion">
<span class="sig-name descname"><span class="pre">background_motion</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#transmotion.dense_motion.BGMotionPredictor" title="transmotion.dense_motion.BGMotionPredictor"><span class="pre">transmotion.dense_motion.BGMotionPredictor</span></a></em><a class="headerlink" href="#transmotion.network_bundle.NetworksBundle.background_motion" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transmotion.network_bundle.NetworksBundle.clear_grads">
<span class="sig-name descname"><span class="pre">clear_grads</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/network_bundle.html#NetworksBundle.clear_grads"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.network_bundle.NetworksBundle.clear_grads" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.network_bundle.NetworksBundle.dense_motion">
<span class="sig-name descname"><span class="pre">dense_motion</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#transmotion.dense_motion.DenseMotionNetwork" title="transmotion.dense_motion.DenseMotionNetwork"><span class="pre">transmotion.dense_motion.DenseMotionNetwork</span></a></em><a class="headerlink" href="#transmotion.network_bundle.NetworksBundle.dense_motion" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transmotion.network_bundle.NetworksBundle.eval">
<span class="sig-name descname"><span class="pre">eval</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/network_bundle.html#NetworksBundle.eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.network_bundle.NetworksBundle.eval" title="Permalink to this definition">#</a></dt>
<dd><p>Turn all networks to eval mode and remove the background prediction network.
Background prediction is not used in prediction</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transmotion.network_bundle.NetworksBundle.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src_img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drv_img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_prob</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#transmotion.network_bundle.NetworkBundleResult" title="transmotion.network_bundle.NetworkBundleResult"><span class="pre">transmotion.network_bundle.NetworkBundleResult</span></a></span></span><a class="reference internal" href="_modules/transmotion/network_bundle.html#NetworksBundle.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.network_bundle.NetworksBundle.forward" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.network_bundle.NetworksBundle.inpaint">
<span class="sig-name descname"><span class="pre">inpaint</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#transmotion.inpainting.InpaintingNetwork" title="transmotion.inpainting.InpaintingNetwork"><span class="pre">transmotion.inpainting.InpaintingNetwork</span></a></em><a class="headerlink" href="#transmotion.network_bundle.NetworksBundle.inpaint" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.network_bundle.NetworksBundle.key_points">
<span class="sig-name descname"><span class="pre">key_points</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#transmotion.kp_detection.KPDetector" title="transmotion.kp_detection.KPDetector"><span class="pre">transmotion.kp_detection.KPDetector</span></a></em><a class="headerlink" href="#transmotion.network_bundle.NetworksBundle.key_points" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transmotion.network_bundle.NetworksBundle.load_original_weights">
<span class="sig-name descname"><span class="pre">load_original_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fpath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/network_bundle.html#NetworksBundle.load_original_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.network_bundle.NetworksBundle.load_original_weights" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transmotion.network_bundle.NetworksBundle.no_background">
<span class="sig-name descname"><span class="pre">no_background</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/network_bundle.html#NetworksBundle.no_background"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.network_bundle.NetworksBundle.no_background" title="Permalink to this definition">#</a></dt>
<dd><p>Copy of Network refernces without the background predictor</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="transmotion.network_bundle.NetworksBundle.parameters">
<span class="sig-name descname"><span class="pre">parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.nn.parameter.Parameter</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/transmotion/network_bundle.html#NetworksBundle.parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.network_bundle.NetworksBundle.parameters" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="transmotion.network_bundle.build_nets">
<span class="sig-prename descclassname"><span class="pre">transmotion.network_bundle.</span></span><span class="sig-name descname"><span class="pre">build_nets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#transmotion.configs.TPSConfig" title="transmotion.configs.TPSConfig"><span class="pre">transmotion.configs.TPSConfig</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dense</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#transmotion.configs.DenseMotionConf" title="transmotion.configs.DenseMotionConf"><span class="pre">transmotion.configs.DenseMotionConf</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">inpaint</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#transmotion.configs.InpaintingConfig" title="transmotion.configs.InpaintingConfig"><span class="pre">transmotion.configs.InpaintingConfig</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#transmotion.network_bundle.NetworksBundle" title="transmotion.network_bundle.NetworksBundle"><span class="pre">transmotion.network_bundle.NetworksBundle</span></a></span></span><a class="reference internal" href="_modules/transmotion/network_bundle.html#build_nets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.network_bundle.build_nets" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="transmotion.network_bundle.chain_param">
<span class="sig-prename descclassname"><span class="pre">transmotion.network_bundle.</span></span><span class="sig-name descname"><span class="pre">chain_param</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">modules</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.nn.parameter.Parameter</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/transmotion/network_bundle.html#chain_param"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.network_bundle.chain_param" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="transmotion.network_bundle.get_kp_normalized_forward_func">
<span class="sig-prename descclassname"><span class="pre">transmotion.network_bundle.</span></span><span class="sig-name descname"><span class="pre">get_kp_normalized_forward_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src_img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intial_drv_img</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#transmotion.network_bundle.NetworksBundle" title="transmotion.network_bundle.NetworksBundle"><span class="pre">transmotion.network_bundle.NetworksBundle</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#transmotion.network_bundle.NetworkBundleResult" title="transmotion.network_bundle.NetworkBundleResult"><span class="pre">transmotion.network_bundle.NetworkBundleResult</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/transmotion/network_bundle.html#get_kp_normalized_forward_func"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.network_bundle.get_kp_normalized_forward_func" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="transmotion.network_bundle.load_original_weights">
<span class="sig-prename descclassname"><span class="pre">transmotion.network_bundle.</span></span><span class="sig-name descname"><span class="pre">load_original_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fpath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#transmotion.network_bundle.NetworksBundle" title="transmotion.network_bundle.NetworksBundle"><span class="pre">transmotion.network_bundle.NetworksBundle</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#transmotion.network_bundle.NetworksBundle" title="transmotion.network_bundle.NetworksBundle"><span class="pre">transmotion.network_bundle.NetworksBundle</span></a></span></span><a class="reference internal" href="_modules/transmotion/network_bundle.html#load_original_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.network_bundle.load_original_weights" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="module-transmotion.nn_blocks">
<span id="transmotion-nn-blocks-module"></span><h2>transmotion.nn_blocks module<a class="headerlink" href="#module-transmotion.nn_blocks" title="Permalink to this headline">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="transmotion.nn_blocks.Decoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transmotion.nn_blocks.</span></span><span class="sig-name descname"><span class="pre">Decoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">block_expansion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_blocks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">256</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/nn_blocks.html#Decoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.nn_blocks.Decoder" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Hourglass Decoder</p>
<dl class="py method">
<dt class="sig sig-object py" id="transmotion.nn_blocks.Decoder.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="_modules/transmotion/nn_blocks.html#Decoder.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.nn_blocks.Decoder.forward" title="Permalink to this definition">#</a></dt>
<dd><p>Take a list of feature maps of shapes <cite>[ … [b, c_i, h_i, w_i]… ]</cite>.
Upsample and add skip connections</p>
<p>TODO:
- [ ] add network arch sketch</p>
<dl class="field-list simple">
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p><cite>x</cite> - output of the src.nn_blocks.Encoder</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.nn_blocks.Decoder.out_channels">
<span class="sig-name descname"><span class="pre">out_channels</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#transmotion.nn_blocks.Decoder.out_channels" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.nn_blocks.Decoder.out_dim">
<span class="sig-name descname"><span class="pre">out_dim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#transmotion.nn_blocks.Decoder.out_dim" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="transmotion.nn_blocks.DownBlock2d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transmotion.nn_blocks.</span></span><span class="sig-name descname"><span class="pre">DownBlock2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/nn_blocks.html#DownBlock2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.nn_blocks.DownBlock2d" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Downsampling block with <cite>Average Pooling</cite></p>
<dl class="py method">
<dt class="sig sig-object py" id="transmotion.nn_blocks.DownBlock2d.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/nn_blocks.html#DownBlock2d.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.nn_blocks.DownBlock2d.forward" title="Permalink to this definition">#</a></dt>
<dd><p>Take feature map tensor as input</p>
<p>Expect input of the shape: <cite>[batch, dim, height, width]</cite></p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="transmotion.nn_blocks.Encoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transmotion.nn_blocks.</span></span><span class="sig-name descname"><span class="pre">Encoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">block_expansion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_blocks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/nn_blocks.html#Encoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.nn_blocks.Encoder" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Hourglass Encoder</p>
<dl class="py method">
<dt class="sig sig-object py" id="transmotion.nn_blocks.Encoder.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/transmotion/nn_blocks.html#Encoder.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.nn_blocks.Encoder.forward" title="Permalink to this definition">#</a></dt>
<dd><ul class="simple">
<li><p>Input shpae: <cite>[batch, c, height, width]</cite></p></li>
<li><p>Output shape: <cite>[ … [batch, c_i, h_i, w_i] …]</cite></p></li>
</ul>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="transmotion.nn_blocks.Hourglass">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transmotion.nn_blocks.</span></span><span class="sig-name descname"><span class="pre">Hourglass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">block_expansion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_blocks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/nn_blocks.html#Hourglass"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.nn_blocks.Hourglass" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Hourglass architecture.
The input is downsampled with a CNN based encoder and upsampled with a CNN based decoder.
A bit similar to a U-Net architecure where each upsampled features map has a residual connection to a downsampled feature map from the decoder.</p>
<dl class="py method">
<dt class="sig sig-object py" id="transmotion.nn_blocks.Hourglass.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/transmotion/nn_blocks.html#Hourglass.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.nn_blocks.Hourglass.forward" title="Permalink to this definition">#</a></dt>
<dd><p>Encoder a feature map <cite>x</cite> and decode it back.
:param: <cite>x</cite> - feature map of shape <cite>[b, c, h, w]</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>List[th.Tensor] intermediate decoder feature maps, with increasing spatial dimensions h_i &amp; w_i ande decreaseing dimension c_i</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.nn_blocks.Hourglass.last_out_dim">
<span class="sig-name descname"><span class="pre">last_out_dim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#transmotion.nn_blocks.Hourglass.last_out_dim" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="transmotion.nn_blocks.Hourglass.out_channels">
<span class="sig-name descname"><span class="pre">out_channels</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#transmotion.nn_blocks.Hourglass.out_channels" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="transmotion.nn_blocks.ResBlock2d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transmotion.nn_blocks.</span></span><span class="sig-name descname"><span class="pre">ResBlock2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/nn_blocks.html#ResBlock2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.nn_blocks.ResBlock2d" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Residual block that preserve spatial resolution</p>
<dl class="py method">
<dt class="sig sig-object py" id="transmotion.nn_blocks.ResBlock2d.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/nn_blocks.html#ResBlock2d.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.nn_blocks.ResBlock2d.forward" title="Permalink to this definition">#</a></dt>
<dd><p>Take feature map tensor as input</p>
<p>Expect input of the shape: <cite>[batch, dim, height, width]</cite></p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="transmotion.nn_blocks.SameBlock2d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transmotion.nn_blocks.</span></span><span class="sig-name descname"><span class="pre">SameBlock2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/nn_blocks.html#SameBlock2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.nn_blocks.SameBlock2d" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Simple block, preserve spatial resolution.</p>
<dl class="py method">
<dt class="sig sig-object py" id="transmotion.nn_blocks.SameBlock2d.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/nn_blocks.html#SameBlock2d.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.nn_blocks.SameBlock2d.forward" title="Permalink to this definition">#</a></dt>
<dd><p><cite>[batch, dim, height, width]</cite></p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="transmotion.nn_blocks.UpBlock2d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transmotion.nn_blocks.</span></span><span class="sig-name descname"><span class="pre">UpBlock2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/nn_blocks.html#UpBlock2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.nn_blocks.UpBlock2d" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Upsampling block for use in decoder.</p>
<dl class="py method">
<dt class="sig sig-object py" id="transmotion.nn_blocks.UpBlock2d.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/nn_blocks.html#UpBlock2d.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.nn_blocks.UpBlock2d.forward" title="Permalink to this definition">#</a></dt>
<dd><p>Take feature map tensor as input</p>
<p>Expect input of the shape: <cite>[batch, dim, height, width]</cite></p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="transmotion.nn_blocks.Vgg19">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">transmotion.nn_blocks.</span></span><span class="sig-name descname"><span class="pre">Vgg19</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vgg_pretrained_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.nn.modules.module.Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/nn_blocks.html#Vgg19"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.nn_blocks.Vgg19" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Vgg19 network for perceptual loss. See Sec 3.3.</p>
<dl class="py method">
<dt class="sig sig-object py" id="transmotion.nn_blocks.Vgg19.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/nn_blocks.html#Vgg19.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.nn_blocks.Vgg19.forward" title="Permalink to this definition">#</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="transmotion.nn_blocks.get_pretrained_vgg19">
<span class="sig-prename descclassname"><span class="pre">transmotion.nn_blocks.</span></span><span class="sig-name descname"><span class="pre">get_pretrained_vgg19</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.nn.modules.module.Module</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/transmotion/nn_blocks.html#get_pretrained_vgg19"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.nn_blocks.get_pretrained_vgg19" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>VGG19 module and the length of its output (number of feature maps)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-transmotion.viz">
<span id="transmotion-viz-module"></span><h2>transmotion.viz module<a class="headerlink" href="#module-transmotion.viz" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="transmotion.viz.draw_points_on_tensors">
<span class="sig-prename descclassname"><span class="pre">transmotion.viz.</span></span><span class="sig-name descname"><span class="pre">draw_points_on_tensors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#transmotion.kp_detection.KPResult" title="transmotion.kp_detection.KPResult"><span class="pre">transmotion.kp_detection.KPResult</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">PIL.Image.Image</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/transmotion/viz.html#draw_points_on_tensors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.viz.draw_points_on_tensors" title="Permalink to this definition">#</a></dt>
<dd><p>Draw predicted key-points on images
:param img_tensor: An image tenosr assumed to be in $[0,1]$ and shape of $(batch_size, dim, h, w)$
:param key_points: Result on predictoin from</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="transmotion.viz.show_on_gird">
<span class="sig-prename descclassname"><span class="pre">transmotion.viz.</span></span><span class="sig-name descname"><span class="pre">show_on_gird</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">img_tnesors</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/viz.html#show_on_gird"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.viz.show_on_gird" title="Permalink to this definition">#</a></dt>
<dd><p>kwargs are passed to torchvision.utils.make_grid</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="transmotion.viz.show_points_on_grid">
<span class="sig-prename descclassname"><span class="pre">transmotion.viz.</span></span><span class="sig-name descname"><span class="pre">show_points_on_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#transmotion.kp_detection.KPResult" title="transmotion.kp_detection.KPResult"><span class="pre">transmotion.kp_detection.KPResult</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">PIL.Image.Image</span></span></span><a class="reference internal" href="_modules/transmotion/viz.html#show_points_on_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.viz.show_points_on_grid" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="module-transmotion.weights">
<span id="transmotion-weights-module"></span><h2>transmotion.weights module<a class="headerlink" href="#module-transmotion.weights" title="Permalink to this headline">#</a></h2>
<p>Module for loading and saving module weights.</p>
<p>Key use cases:</p>
<ul class="simple">
<li><p>Port pretrained weights from original repo to this one</p></li>
</ul>
<dl class="py function">
<dt class="sig sig-object py" id="transmotion.weights.import_state_dict">
<span class="sig-prename descclassname"><span class="pre">transmotion.weights.</span></span><span class="sig-name descname"><span class="pre">import_state_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">old</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="_modules/transmotion/weights.html#import_state_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.weights.import_state_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Use heuristics to load weights from original paper to current weights.
Models haven’t changed much from the original, mostly ordered stayed the same.</p>
<p><strong>The matching heuristics are as follows</strong>:</p>
<ol class="arabic simple">
<li><p>Match according to weight shapes (model must have the same shapes and the same number of weight for each shape)</p></li>
<li><p>In case more than one weight share shape, perform text similarity on weight name, make sure that the order of old weights matches the order of new weights</p></li>
</ol>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="transmotion.weights.param_name_iou">
<span class="sig-prename descclassname"><span class="pre">transmotion.weights.</span></span><span class="sig-name descname"><span class="pre">param_name_iou</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">left_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/transmotion/weights.html#param_name_iou"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.weights.param_name_iou" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="transmotion.weights.reconcile_weights">
<span class="sig-prename descclassname"><span class="pre">transmotion.weights.</span></span><span class="sig-name descname"><span class="pre">reconcile_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orig_state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/transmotion/weights.html#reconcile_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#transmotion.weights.reconcile_weights" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="module-transmotion">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-transmotion" title="Permalink to this headline">#</a></h2>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          <a class="prev-page" href="modules.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">transmotion</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022, Gregory Axler
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">transmotion package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-transmotion.blocks">transmotion.blocks module</a></li>
<li><a class="reference internal" href="#module-transmotion.configs">transmotion.configs module</a></li>
<li><a class="reference internal" href="#module-transmotion.cord_warp">transmotion.cord_warp module</a></li>
<li><a class="reference internal" href="#module-transmotion.data_loading">transmotion.data_loading module</a></li>
<li><a class="reference internal" href="#module-transmotion.datasets">transmotion.datasets module</a></li>
<li><a class="reference internal" href="#module-transmotion.debug">transmotion.debug module</a></li>
<li><a class="reference internal" href="#module-transmotion.dense_motion">transmotion.dense_motion module</a></li>
<li><a class="reference internal" href="#module-transmotion.inpainting">transmotion.inpainting module</a></li>
<li><a class="reference internal" href="#module-transmotion.kp_detection">transmotion.kp_detection module</a></li>
<li><a class="reference internal" href="#module-transmotion.network_bundle">transmotion.network_bundle module</a></li>
<li><a class="reference internal" href="#module-transmotion.nn_blocks">transmotion.nn_blocks module</a></li>
<li><a class="reference internal" href="#module-transmotion.viz">transmotion.viz module</a></li>
<li><a class="reference internal" href="#module-transmotion.weights">transmotion.weights module</a></li>
<li><a class="reference internal" href="#module-transmotion">Module contents</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/scripts/furo.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>